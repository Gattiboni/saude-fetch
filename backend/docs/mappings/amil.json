{
  "meta": { "provider": "amil", "task": "cpf-eligibility", "version": "1.0.2" },
  "navigate": {
    "url": "https://www.amil.com.br/institucional/#/servicos/saude/rede-credenciada/amil/busca-avancada",
    "expand_recursively": true,
    "wait_for_react": true,
    "reuse_page": true
  },
  "steps": [
    {
      "action": "navigate",
      "target": "https://www.amil.com.br/institucional/#/servicos/saude/rede-credenciada/amil/busca-avancada",
      "description": "Garantir que a navegação abra o fluxo correto"
    },
    {
      "action": "click_if_exists",
      "selector": "legend.d-none + div.collapse:not(.show) .accordion-button, legend.d-none",
      "description": "Expandir painel do Passo 1 se estiver colapsado"
    },
    {
      "action": "wait_for",
      "selector": "div.collapse.show input[name='cpf']",
      "timeout_ms": 8000,
      "description": "Aguardar campo de CPF visível após expansão"
    },
    {
      "action": "fill",
      "selector": "div.collapse.show input[name='cpf']",
      "value": "{identifier}",
      "description": "Preencher CPF"
    },
    {
      "action": "press",
      "key": "Enter",
      "description": "Pressionar ENTER após preencher CPF"
    },
    {
      "action": "wait_for_any",
      "selectors": [
        "div.modal-content",
        "div.rw-dropdown-list-input"
      ],
      "timeout_ms": 8000,
      "description": "Aguardar retorno da consulta"
    }
  ],
  "result_parsing": {
    "negative_selector": "div.modal-content:has-text('não encontramos')",
    "positive_selector": "div.rw-dropdown-list-input"
  }
}
