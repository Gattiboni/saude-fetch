{
  "operator": "bradesco",
  "start_url": "https://www.bradescoseguros.com.br/clientes/produtos/plano-saude/consulta-de-rede-referenciada",
  "wait_for_any": "input#searchCpfOrCard",
  "block_indicators": [
    "text=/temporariamente indisponível/i",
    "text=/verifique se você é humano/i",
    "#challenge-running"
  ],
  "steps": [
    {
      "action": "navigate",
      "target": "https://www.bradescoseguros.com.br/clientes/produtos/plano-saude/consulta-de-rede-referenciada",
      "timeout_ms": 20000
    },
    {
      "action": "click",
      "selector": "#onetrust-accept-btn-handler, button[id*='onetrust'], button[data-testid='accept-all'], button:has-text('Aceitar'), button:has-text('Continuar'), #adopt-accept-all-button",
      "timeout_ms": 3000,
      "optional": true
    },
    {
      "action": "wait_for_timeout",
      "timeout_ms": 500
    },
    {
      "action": "fill",
      "selector": "input#searchCpfOrCard",
      "timeout_ms": 20000
    },
    {
      "action": "keypress",
      "selector": "input#searchCpfOrCard",
      "key": "Enter",
      "timeout_ms": 15000
    },
    {
      "action": "wait_for",
      "selector": [
        "div.bs-modal__container strong.bs-alert__title",
        "text=/beneficiário não encontrado/i",
        "text=/selecione o beneficiário/i"
      ],
      "timeout_ms": 20000
    },
    {
      "action": "evaluate",
      "script": "(() => { const el = document.querySelector('div.bs-modal__container strong.bs-alert__title'); if (!el) return 'indefinido'; const txt = (el.innerText || '').trim().toLowerCase(); if (txt.includes('não encontrado')) return 'negativo'; if (txt.includes('selecione o beneficiário')) return 'positivo'; return 'indefinido'; })()",
      "timeout_ms": 10000
    },
    {
      "action": "keyboard",
      "key": "Escape",
      "timeout_ms": 1000
    },
    {
      "action": "wait_for_timeout",
      "timeout_ms": 300
    }
  ]
}
