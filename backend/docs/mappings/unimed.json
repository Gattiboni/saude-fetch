{
  "meta": { "provider": "unimed", "task": "cpf-eligibility", "version": "1.0.0" },
  "navigate": {
    "url": "https://www.unimed.coop.br/site/guia-medico#/",
    "expand_recursively": true,
    "reuse_page": true,
    "geolocation": "allow_if_asked"
  },
  "inputs": {
    "cpf": { "selector": "#client-input", "type": "text", "mask": "cpf", "submit": "none", "clear": true }
  },
  "steps": [
    { "wait": { "ms": 3500 } },
    {
      "conditional": [
        {
          "if": { "exists": { "selector": ".NoCardAvailable--text", "text_contains": "não foi possível localizar os seus dados" } },
          "then": [
            { "set": { "result": "negative", "reason": "Não encontrado" } }
          ]
        },
        {
          "if": { "exists": { "selector": "img[src$='check-ok-green.svg']" } },
          "then": [
            { "set": { "result": "positive" } },
            { "extract": { "plan_name": { "selector": "#NameIdenticadedUser strong", "attribute": "innerText", "optional": true } } }
          ]
        }
      ]
    }
  ],
  "loop": { "reenter_on": "next_input", "keep_page_open": true },
  "errors": { "on_timeout": "retry_once_then_fail" }
}